═══════════════════════════════════════════════════════════════
ONE-LINER COMMANDS TO DOWNLOAD & EXECUTE CLEAR-SERVERCACHE.PS1 FROM GITHUB
═══════════════════════════════════════════════════════════════

POWERSHELL ONE-LINER (Copy & Paste - PowerShell 5.x Compatible):
───────────────────────────────────────────────────────────────
powershell.exe -ExecutionPolicy Bypass -Command "[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12;(Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/monobrau/windows-network-config/main/duoproxyupdate/Clear-ServerCache.ps1' -UseBasicParsing).Content|Out-File -FilePath (Join-Path $env:TEMP 'Clear-ServerCache.ps1') -Encoding UTF8;& (Join-Path $env:TEMP 'Clear-ServerCache.ps1')"

POWERSHELL ONE-LINER (Shorter - Direct Execution - PowerShell 5.x Compatible):
───────────────────────────────────────────────────────────────
powershell.exe -ExecutionPolicy Bypass -Command "[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12;iex((Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/monobrau/windows-network-config/main/duoproxyupdate/Clear-ServerCache.ps1' -UseBasicParsing).Content)"

RECOMMENDED (Download to file first - bypasses cache issues - USE THIS ON SERVERS):
───────────────────────────────────────────────────────────────
powershell.exe -ExecutionPolicy Bypass -Command "[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12;`$f=Join-Path `$env:TEMP Clear-ServerCache.ps1;Remove-Item `$f -ErrorAction SilentlyContinue;Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/monobrau/windows-network-config/main/duoproxyupdate/Clear-ServerCache.ps1' -OutFile `$f -UseBasicParsing;powershell.exe -ExecutionPolicy Bypass -File `$f"

CMD/BATCH ONE-LINER (PowerShell 5.x Compatible):
───────────────────────────────────────────────────────────────
powershell.exe -ExecutionPolicy Bypass -Command "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/monobrau/windows-network-config/main/duoproxyupdate/Clear-ServerCache.ps1' -OutFile %TEMP%\Clear-ServerCache.ps1 -UseBasicParsing; powershell.exe -ExecutionPolicy Bypass -File %TEMP%\Clear-ServerCache.ps1"

RUN AS ADMINISTRATOR (For full cache clearing including DNS and Windows Update):
───────────────────────────────────────────────────────────────
powershell.exe -ExecutionPolicy Bypass -Command "Start-Process powershell.exe -ArgumentList '-ExecutionPolicy Bypass -Command \"[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12;`$f=Join-Path `$env:TEMP Clear-ServerCache.ps1;Remove-Item `$f -ErrorAction SilentlyContinue;Invoke-WebRequest -Uri ''https://raw.githubusercontent.com/monobrau/windows-network-config/main/duoproxyupdate/Clear-ServerCache.ps1'' -OutFile `$f -UseBasicParsing;powershell.exe -ExecutionPolicy Bypass -File `$f\"' -Verb RunAs"

═══════════════════════════════════════════════════════════════
USAGE:
───────────────────────────────────────────────────────────────
1. Copy one of the commands above
2. Paste into PowerShell or CMD prompt
3. Press Enter
4. Script downloads and executes automatically
5. For full functionality (DNS cache, Windows Update cache), use the "RUN AS ADMINISTRATOR" command

═══════════════════════════════════════════════════════════════
NOTES:
───────────────────────────────────────────────────────────────
- All commands are compatible with PowerShell 5.1+ (Windows 10/11 default)
- TLS 1.2 is enabled automatically for GitHub HTTPS connections
- **RECOMMENDED command** (third one) downloads to temp folder first - best for server use
- Use "RUN AS ADMINISTRATOR" command for full cache clearing (DNS, Windows Update, etc.)
- Script will show which operations require Administrator privileges
- After clearing cache, try downloading your script again to get fresh version

═══════════════════════════════════════════════════════════════
